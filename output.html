<!DOCTYPE html />

<html>
<head>
	<title>output.js</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<link href="nocco.css" rel="stylesheet" media="all" type="text/css" />
	<script src="prettify.js" type="text/javascript"></script>
</head>
<body onload="prettyPrint()">
	<div id="container">
		<div id="background"></div>
			<div id="jump_to">
				Jump To &hellip;
				<div id="jump_wrapper">
					<div id="jump_page">
							<a class="source" href="coeffanalyse.html">
								CoeffAnalyse.js
							</a>
							 
							<a class="source" href="engine.html">
								engine.js
							</a>
							 
							<a class="source" href="exporter.html">
								exporter.js
							</a>
							<a class="source" href="global.html">
								global.js
							</a>
							<a class="source" href="importer.html">
								importer.js
							</a>
							<a class="source" href="index.html">
								index.js
							</a>
							<a class="source" href="locationpicker.jquery.html">
								locationpicker.jquery.js
							</a>
							<a class="source" href="output.html">
								output.js
							</a>
							<a class="source" href="privacy-policy.html">
								privacy-policy.js
							</a>
							<a class="source" href="record.html">
								record.js
							</a>
							<a class="source" href="support.html">
								support.js
							</a>
							 
					</div>
				</div>
			</div>
		<table cellpadding="0" cellspacing="0">
			<thead>
				<tr>
					<th class="docs">
						<h1>output.js</h1>
					</th>
					<th class="code"></th>
				</tr>
			</thead>
			<tbody>
					<tr id="section_1">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_1">&#182;</a>
							</div>
							<p>Massacred by twobob for HTML5 
Will mod 17/2/2017</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>google.load(&quot;visualization&quot;, &quot;1.1&quot;, {packages:[&quot;corechart&quot;, &quot;table&quot;]}); 
</code></pre>
						</td>
					</tr>
					<tr id="section_2">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_2">&#182;</a>
							</div>
							<p>end mod</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>function _f__SetAnalysisMethod(num){
	method = parseInt(num);
	_f__ClickedxProfile();
}



function _f__drawChart(title, arrayToDraw, idOfDivToUse) {
	var data = &quot;&quot;;
	var options = &quot;&quot;;
	var seriesBarColor = &quot;#518EAB&quot;;

	if(idOfDivToUse.includes(&quot;2&quot;))
		seriesBarColor = &quot;#71BEDB&quot;;
</code></pre>
						</td>
					</tr>
					<tr id="section_3">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_3">&#182;</a>
							</div>
							<p>seriesBarColour = "FFFF00";</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
	if(!$(&quot;#chartsHolder&quot;).dialog( &quot;isOpen&quot; ))
		$(&quot;#chartsHolder&quot;).dialog( &quot;open&quot; );

</code></pre>
						</td>
					</tr>
					<tr id="section_4">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_4">&#182;</a>
							</div>
							<p>we only need to do this for chart type 1 - chart type 0 has percentage-spaced horizontal bars</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	if ( OptionsObject.chartType==1 )
	{
		var stats = { mean: 0, sd: 0, sError: 0, skew: 0 };
		compositeThemeValues ( arrayToDraw );
		for ( n = 0 ; n &lt; arrayToDraw.length; n++ )
			arrayToDraw[n] = avgThemeVal[n];

</code></pre>
						</td>
					</tr>
					<tr id="section_5">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_5">&#182;</a>
							</div>
							<p>warning this alters the stats!
    normaliseValues ( arrayToDraw, arrayToDraw.length );</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>		statAnalyse ( arrayToDraw, 0, arrayToDraw.length, stats, 0 );	// pop. std. dev.
/*
debugP(&quot;output&quot;);
debugP(&quot;s mean &quot;+pNum(stats.mean, 3));
debugP(&quot;s sd &quot;+pNum(stats.sd, 3));
*/
		var lo = stats.mean-(stats.sd*sigmaFactor);
		var hi = stats.mean+(stats.sd*sigmaFactor);
		var mean = stats.mean ;
/*
debugP(&quot;output.js &quot;+title+&quot; type 1 statistics:&quot;);
debugP(&quot;output.js type 1 array:&quot;);
for ( n= 0 ; n &lt; 12; n++ )
debugP(pNum(arrayToDraw[n], precision));
debugP(&quot;mean: &quot;+pNum(mean, precision));
debugP(&quot;sigma: &quot;+pNum(stats.sd, precision));
debugP(&quot;limits (+/ 1 sigma): &quot;+pNum(lo, precision)+&quot;, &quot;+pNum(hi, precision));
debugP(&quot;std error on mean: s = &quot;+pNum(sStats.sError, precision)+&quot; t = &quot;+pNum(tStats.sError, precision));
debugP(&quot;&quot;);
*/

</code></pre>
						</td>
					</tr>
					<tr id="section_6">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_6">&#182;</a>
							</div>
							<p>second mean duplicate is to wangle bar logic. we have to draw it FIRST and LAST to make this hack work.
colour spec here doesn't apply either (was 'red') - hidden?</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>		data = google.visualization.arrayToDataTable(
        [
            [&#39;theme&#39;, &#39;amount&#39;, {id:&#39;i0&#39;, type: &#39;number&#39;, label: &#39;Mean&#39;, role: &#39;interval&#39;}, {id:&#39;i1&#39;,type: &#39;number&#39;, label: &#39;hi&#39;, role: &#39;interval&#39;, color: &#39;yellow&#39;}, {id:&#39;i2&#39;,type: &#39;number&#39;, label: &#39;lo&#39;, role: &#39;interval&#39;},{id:&#39;i0&#39;,type: &#39;number&#39;, label: &#39;&#39;, role: &#39;interval&#39;}],
            [&#39;1&#39;, arrayToDraw[0],mean, lo, hi ,mean  ],
            [&#39;2&#39;, arrayToDraw[1],mean, lo, hi ,mean  ],
            [&#39;3&#39;, arrayToDraw[2],mean, lo, hi ,mean  ],
            [&#39;4&#39;, arrayToDraw[3],mean, lo, hi   ,mean],
            [&#39;5&#39;, arrayToDraw[4],mean, lo, hi   ,mean],
            [&#39;6&#39;, arrayToDraw[5],mean, lo, hi   ,mean],
            [&#39;7&#39;, arrayToDraw[6],mean, lo, hi   ,mean],
            [&#39;8&#39;, arrayToDraw[7],mean, lo, hi   ,mean],
            [&#39;9&#39;, arrayToDraw[8],mean, lo, hi   ,mean],
            [&#39;10&#39;, arrayToDraw[9],mean, lo, hi  ,mean],
            [&#39;11&#39;, arrayToDraw[10],mean, lo, hi ,mean],
            [&#39;12&#39;, arrayToDraw[11],mean, lo, hi ,mean]
        ]);

</code></pre>
						</td>
					</tr>
					<tr id="section_7">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_7">&#182;</a>
							</div>
							<p>SIMON HACKING 5/3/2018 on Bar charts annotations to make lines. 
make those lines wider, handle multiple points in the same spot gracefully and silently. Basically don't annoy Will.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>		options = {
		width: 360,
		height: 200,
	
	interval: {
            &#39;i0&#39;: { &#39;style&#39;:&#39;line&#39;, &#39;color&#39;:&#39;#D3362D&#39;, &#39;lineWidth&#39;: 0.5 },
            &#39;i1&#39;: { &#39;style&#39;:&#39;line&#39;, &#39;color&#39;:&#39;#F1CA3A&#39;, &#39;lineWidth&#39;: 1 },
            &#39;i2&#39;: { &#39;style&#39;:&#39;line&#39;, &#39;color&#39;:&#39;#5F9654&#39;, &#39;lineWidth&#39;: 2 },
        },

	
        orientation: &#39;horizontal&#39;,
		bar: {
		groupWidth: &quot;99%&quot;
        },
		seriesType: &#39;bars&#39;,
		intervals: {
			shortBarWidth: &#39;5&#39;,
			barWidth: &#39;5&#39;,
			pointSize : 0
		},
		
        series: {
			0: {type: &#39;bars&#39;,
				color: seriesBarColor
			},
			3: {
				type: &#39;line&#39;
			},
			4: {
				type: &#39;line&#39;
			}
		},
        enableInteractivity: true,
</code></pre>
						</td>
					</tr>
					<tr id="section_8">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_8">&#182;</a>
							</div>
							<p>bg is for type 1 chart</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>        backgroundColor: &#39;#D3E0E8&#39;,
         title: title,
        legend: &#39;none&#39;,
        chartArea: {
			width: &#39;100%&#39;,
			height: &#39;80%&#39;
		},
        hAxis: {
			showTextEvery: 1,
			title: &#39;&#39;,
			minValue: 0
		},
        vAxis: {
			showTextEvery: 1,
			gridlines: {
				color: &#39;transparent&#39;
			},
			title: &#39;&#39;
		}
	};
}
else  // Chart 0 and any chart not chart 1
{
/*
debugP(&quot;output: type 1 array&quot;);
for ( n= 0 ; n &lt; 12; n++ )
debugP(pNum(arrayToDraw[n], precision));
*/
	normaliseValues ( arrayToDraw, arrayToDraw.length );

	var vCount =6;

</code></pre>
						</td>
					</tr>
					<tr id="section_9">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_9">&#182;</a>
							</div>
							<p>second mean duplicate is to wangle bar logic. we have to draw it FIRST and LAST to make this hack work.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>     data = google.visualization.arrayToDataTable(
        [
            [&#39;theme&#39;, &#39;amount&#39;],
            [&#39;1&#39;, arrayToDraw[0]],
            [&#39;2&#39;, arrayToDraw[1]],
            [&#39;3&#39;, arrayToDraw[2]],
            [&#39;4&#39;, arrayToDraw[3]],
            [&#39;5&#39;, arrayToDraw[4]],
            [&#39;6&#39;, arrayToDraw[5]],
            [&#39;7&#39;, arrayToDraw[6]],
            [&#39;8&#39;, arrayToDraw[7]],
            [&#39;9&#39;, arrayToDraw[8]],
            [&#39;10&#39;, arrayToDraw[9]],
            [&#39;11&#39;, arrayToDraw[10]],
            [&#39;12&#39;, arrayToDraw[11]]
        ]);

		
</code></pre>
						</td>
					</tr>
					<tr id="section_10">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_10">&#182;</a>
							</div>
							<p>ORIGINAL PRE-HACK OPTIONS   6/3/2018  SJR</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>    options = {
		 width: 360,
		 height: 200,
	
        orientation: &#39;horizontal&#39;,
        bar: {
            groupWidth: &quot;99%&quot;
        },
        series: {
            0: {
                color: seriesBarColor
            }
        },
        enableInteractivity: false,
        backgroundColor: &#39;#D3E0E8&#39;,
        title: title,
        legend: &#39;none&#39;,
        chartArea: {
           width: &#39;100%&#39;,
            height: &#39;80%&#39;
        },
        hAxis: {
            showTextEvery: 1,
            title: &#39;&#39;,
            minValue: 0
        },
        vAxis: {
            showTextEvery: 1,
            gridlines: {
</code></pre>
						</td>
					</tr>
					<tr id="section_11">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_11">&#182;</a>
							</div>
							<pre><code>           color: 'transparent'
</code></pre>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>color: &quot;red&quot;,
count: vCount
            },
            title: &#39;&#39;
        }
    };

		

}



</code></pre>
						</td>
					</tr>
					<tr id="section_12">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_12">&#182;</a>
							</div>
							<p>Do this in all cases.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
	
    var chart = new google.visualization.BarChart(document.getElementById(idOfDivToUse));

	
    chart.draw(data, options);

</code></pre>
						</td>
					</tr>
					<tr id="section_13">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_13">&#182;</a>
							</div>
							<p>$(idOfDivToUse).show();</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
	
}

function _f__makeBarColour(barColour, TOBaccurate){ 
var blueTint = 0.655;
var redTint = 0.314;
var greenTint = 0.557;

if (method&gt;1 &amp;&amp; method&lt;4)
{
	if (barColour&lt;0 &amp;&amp; barColour&gt;-4)
	{
		redTint = 1-(Math.abs(barColour+1)/4);
		greenTint = 0;
		blueTint = 0;
	}
	if (barColour&gt;=0 &amp;&amp; barColour&lt;3)
	{
		greenTint = 1-(barColour/4);
		blueTint = 0;
		redTint = 0;
	}
}

if ( (method == 1) &amp;&amp; (TOBaccurate == &#39;false&#39;) )	// recolour entries with flagged inaccurate bt
{	// a few shades lighter than the default
	redTint = 0.44;
	greenTint = 0.78;
	blueTint = 0.917;
}

redTint = Math.floor(redTint*255);
greenTint = Math.floor(greenTint*255);
blueTint = Math.floor(blueTint*255);
return &#39;rgb(&#39;+redTint+&#39;,&#39;+greenTint+&#39;,&#39;+blueTint+&#39;)&#39;;
}


function _f__drawxProfileChart(title, arrayToDraw, idOfDivToUse, stats) {

debugP(&quot;output.js _f__drawxProfileChart()&quot;);
debugP(&quot;Fit statistics:&quot;);
var mean;
mean = stats.mean;
</code></pre>
						</td>
					</tr>
					<tr id="section_14">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_14">&#182;</a>
							</div>
							<p>forced 1/2 std. dev here even if sigma is `1 for type1 graph?
this is a pop. std. dev. not the subject/target data sigma!
var lo = stats.mean-(stats.sd<em>sigmaFactor);
var hi = stats.mean+(stats.sd</em>sigmaFactor);</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>var lo = stats.mean-(stats.sd*0.5);
var hi = stats.mean+(stats.sd*0.5);
debugP(&quot;mean &quot;+pNum(stats.mean, precision)+&quot; std. dev. &quot;+pNum(stats.sd, precision)+&quot; limits: lo &quot;+pNum(lo, precision)+&quot; hi &quot;+pNum(hi, precision));
</code></pre>
						</td>
					</tr>
					<tr id="section_15">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_15">&#182;</a>
							</div>
							<p>reset graph to offset by mean</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
var mean = 0;
</code></pre>
						</td>
					</tr>
					<tr id="section_16">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_16">&#182;</a>
							</div>
							<p>lo = -stats.sd<em>sigmaFactor;
hi = stats.sd</em>sigmaFactor;</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>lo = -stats.sd*0.5;
hi = stats.sd*0.5;
debugP(&quot;adjusted mean &quot;+pNum(mean, precision)+&quot; std. dev. &quot;+pNum((stats.sd*sigmaFactor), precision)+&quot; limits: lo &quot;+pNum(lo, precision)+&quot; hi &quot;+pNum(hi, precision));

</code></pre>
						</td>
					</tr>
					<tr id="section_17">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_17">&#182;</a>
							</div>
							<p>need vertical lines on the xProfile chart at lo, mean, hi</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	if(!$(&quot;#xchartsHolder&quot;).dialog( &quot;isOpen&quot; ))
		$(&quot;#xchartsHolder&quot;).dialog( &quot;open&quot; );

	$(&#39;.xchartsHolder&#39;).show();
	$(&#39;.chartsHolder&#39;).hide();
	var data = new google.visualization.DataTable();
</code></pre>
						</td>
					</tr>
					<tr id="section_18">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_18">&#182;</a>
							</div>
							<p>data.addColumn('string','id');   </p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>    data.addColumn(&#39;string&#39;, &#39;Name&#39;);
    data.addColumn(&#39;number&#39;, &#39;Weight&#39;);
    data.addColumn({type: &#39;string&#39;, role: &#39;style&#39;});
	data.addColumn({id:&#39;i0&#39;, type: &#39;number&#39;, label: &#39;mean&#39;, role: &#39;interval&#39;});
	data.addColumn({id:&#39;i1&#39;, type: &#39;number&#39;, label: &#39;lo&#39;, role: &#39;interval&#39;});
	data.addColumn({id:&#39;i2&#39;, type: &#39;number&#39;, label: &#39;hi&#39;, role: &#39;interval&#39;});
	data.addColumn({id:&#39;i0&#39;, type: &#39;number&#39;, label: &#39;&#39;, role: &#39;interval&#39;}); // fudge...
	data.addColumn({type: &#39;string&#39;, role: &#39;annotation&#39;});
	data.addColumn({type: &#39;string&#39;, role: &#39;annotationText&#39;});

	$.each(arrayToDraw, function  (key, value) {
var expressed = _f__makeBarColour(value[2], value[3]);
	
</code></pre>
						</td>
					</tr>
					<tr id="section_19">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_19">&#182;</a>
							</div>
							<p>data.addRow([value[0],value[1], expressed  ,    mean, lo, hi ,mean,       value[0].toString(), value[1].toFixed(3) +': '+value[0].toString()] );</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
data.addRow([value[0],value[1], expressed  ,    mean, lo, hi ,mean,       value[0].toString(), value[1].toFixed(3) +&#39;: &#39;+value[0].toString()] );
     });

</code></pre>
						</td>
					</tr>
					<tr id="section_20">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_20">&#182;</a>
							</div>
							<p>setup the options.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>    var options = {
		tooltip: {
		isHtml:true
</code></pre>
						</td>
					</tr>
					<tr id="section_21">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_21">&#182;</a>
							</div>
							<p>ignoreBounds: true</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>   
  },
		annotations: { alwaysOutside: false},
		
		interval: {
            &#39;i0&#39;: { &#39;style&#39;:&#39;line&#39;, &#39;color&#39;:&#39;#D3362D&#39;, &#39;lineWidth&#39;: 0.5 },
            &#39;i1&#39;: { &#39;style&#39;:&#39;line&#39;, &#39;color&#39;:&#39;#F1CA3A&#39;, &#39;lineWidth&#39;: 1 },
            &#39;i2&#39;: { &#39;style&#39;:&#39;line&#39;, &#39;color&#39;:&#39;#5F9654&#39;, &#39;lineWidth&#39;: 2 },
        },
		intervals: {
			shortBarWidth: &#39;5&#39;,
			barWidth: &#39;5&#39;,
			pointSize : 0
		},
		&#39;allowHtml&#39;: true,
		 width: &#39;90%&#39;,
		 height:  &#39;100%&#39;,
        orientation: &#39;vertical&#39;,
        bar: {
            groupWidth: &quot;99%&quot;
        },
        enableInteractivity: true,
        backgroundColor: &#39;#D3E0E8&#39;,
        title: title,
        legend: &#39;none&#39;,
        chartArea: {
            width: &#39;80%&#39;,
            height: &#39;80%&#39;
        },
      
        vAxis: {
       textPosition: &#39;none&#39;,
            title: &#39;&#39;
		
        },
        hAxis: {
			format: &#39;short&#39;
          
		}
    };
    var chart = new google.visualization.BarChart(document.getElementById(idOfDivToUse));
    chart.draw(data, options);
/* 	 */$(&#39;.xchartsHolder&#39;).show();
}

function _f__drawWeightingChart(title, nameArray, arrayToDraw, idOfDivToUse) {
</code></pre>
						</td>
					</tr>
					<tr id="section_22">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_22">&#182;</a>
							</div>
							<p>alert(arrayToDraw);</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
	
	
	  var data = google.visualization.arrayToDataTable(
        [
</code></pre>
						</td>
					</tr>
					<tr id="section_23">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_23">&#182;</a>
							</div>
							<p>where's names gone?</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>            [&#39;Weighting&#39;, nameArray[0], nameArray[1], ],
            [&#39;&#39;, arrayToDraw[0], arrayToDraw[1]]
        ]);
</code></pre>
						</td>
					</tr>
					<tr id="section_24">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_24">&#182;</a>
							</div>
							<p>data.addColumn({type: 'string', role: 'annotationText'});</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	
</code></pre>
						</td>
					</tr>
					<tr id="section_25">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_25">&#182;</a>
							</div>
							<p>data[0, 0, 0]=  "TEST";</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	
	
</code></pre>
						</td>
					</tr>
					<tr id="section_26">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_26">&#182;</a>
							</div>
							<p>$('#' + idOfDivToUse).show();</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
	var bg = &#39;#d3e0e8&#39;;
	
</code></pre>
						</td>
					</tr>
					<tr id="section_27">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_27">&#182;</a>
							</div>
							<p>legend: { position: 'top', maxLines: 3 },</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	
</code></pre>
						</td>
					</tr>
					<tr id="section_28">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_28">&#182;</a>
							</div>
							<p>relative strength bar options</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	 var options = {
         width: 350,
</code></pre>
						</td>
					</tr>
					<tr id="section_29">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_29">&#182;</a>
							</div>
							<pre><code>      height: '70',
</code></pre>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	      height: &#39;50&#39;,
        legend:  {position: &#39;none&#39;},
         bar: { groupWidth: &#39;100%&#39; },
		 enableInteractivity: true,
        isStacked: true,
		  backgroundColor: &#39;#d3e0e8&#39;,
		   colors:[&#39;#518EAB&#39;,&#39;#71bEdB&#39;],
		  hAxis: {
			  	 baselineColor: bg,
         gridlineColor: bg,
         textPosition: &#39;none&#39;,
            showTextEvery: 1,
            title: &#39;&#39;
        },
        vAxis: {
			 baselineColor: bg,
         gridlineColor: bg,
         textPosition: &#39;none&#39;,
            showTextEvery: 1,
            gridlines: {
                color: &#39;transparent&#39;
            },
            title: &#39;&#39;
        } 
    
		  
      };
	
</code></pre>
						</td>
					</tr>
					<tr id="section_30">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_30">&#182;</a>
							</div>
							<p>setup the options.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>   /*  var options = {
        orientation: &#39;vertical&#39;,
        bar: {
            groupWidth: &quot;99%&quot;
        },
        series: {
            0: {
                color: &#39;#518EAB&#39;
            }
        },
        enableInteractivity: true,
        backgroundColor: &#39;#D3E0E8&#39;,
		isStacked: true,
		isStacked: &#39;percent&#39;,
        title: title,
        legend: &#39;none&#39;,
        chartArea: {
            width: &#39;100%&#39;,
            height: &#39;80%&#39;
        },
        hAxis: {
            showTextEvery: 1,
            title: &#39;&#39;
        },
        vAxis: {
            showTextEvery: 1,
            gridlines: {
                color: &#39;transparent&#39;
            },
            title: &#39;&#39;
        }
    }; */

    var chart = new google.visualization.BarChart(document.getElementById(idOfDivToUse));

    chart.draw(data, options);
}

function _f__GenerateChart() {
</code></pre>
						</td>
					</tr>
					<tr id="section_31">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_31">&#182;</a>
							</div>
							<p>Add a test that prevents anyone clicking RUN CHARTS without first loading  decent data</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>      if(!_f__RecordEntriesAreNoneZero(SubjectsValues))
	  {
		  
		  _f__infoP(&quot;Load a subject with sensible positions, Thank you&quot;);
		  return;
	  }
	    if(!_f__RecordEntriesAreNoneZero(TargetsValues))
	  {
		  
		  _f__infoP(&quot;Load a target with sensible positions, Thank you&quot;);
		  return;
	  }


if(!$(&quot;#chartsHolder&quot;).dialog( &quot;isOpen&quot; ))
	{
		
		$(&quot;#chartsHolder&quot;).dialog( &quot;open&quot; );
		
		
	}


	$(&#39;.chartsHolder&#39;).show();

	$(&#39;.xchartsHolder&#39;).hide();


	
</code></pre>
						</td>
					</tr>
					<tr id="section_32">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_32">&#182;</a>
							</div>
							<p>end sanity test</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	  
</code></pre>
						</td>
					</tr>
					<tr id="section_33">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_33">&#182;</a>
							</div>
							<p>we made it clear the warnings that we have hanging around.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>    _f__warnClear();
	

</code></pre>
						</td>
					</tr>
					<tr id="section_34">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_34">&#182;</a>
							</div>
							<p>arrange the optionsObject to be sane</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	_f__DoCompleteOptionsSaveThenLoadCycle();

	
</code></pre>
						</td>
					</tr>
					<tr id="section_35">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_35">&#182;</a>
							</div>
							<p>wangle the data into the various arrays</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	_f__LoadBothChartsData( $(&#39;#SubjectName&#39;).val(), $(&#39;#TargetName&#39;).val()  );
   

</code></pre>
						</td>
					</tr>
					<tr id="section_36">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_36">&#182;</a>
							</div>
							<p>Removed HTML4 Support
Added HTML5 Support</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
</code></pre>
						</td>
					</tr>
					<tr id="section_37">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_37">&#182;</a>
							</div>
							<p>actually draw</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>    _f__drawChart($(&#39;#SubjectName&#39;).val(), SubjectProcessedData, &#39;chart_div_1&#39;);
	
    _f__drawChart($(&#39;#TargetName&#39;).val(), TargetsProcessedData, &#39;chart_div_2&#39;);

	
</code></pre>
						</td>
					</tr>
					<tr id="section_38">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_38">&#182;</a>
							</div>
							<p>Build a full report for W18 on the button.</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
	
var subReporter = &quot;Chart for &quot; +$(&#39;#SubjectName&#39;).val();
	
var	reporter = [];
var sLength = SubjectProcessedData.length;
reporter[reporter.length] =subReporter;	


subReporter = &quot;&quot;;
    for (l = 0; l &lt; sLength; l++) {
		var sliced = SubjectProcessedData[l].toString().slice(0,6);

	if ( sliced.length&gt;1 )
	{
		subReporter +=  _f__pad(sliced, 6, &quot;0&quot;);
		if ( l != sLength-1 )
			subReporter += &quot;,&quot;;
	}
	else
	{
		subReporter += sliced;
		if ( l != sLength-1 )
			subReporter += &quot;,&quot;;
	}
}
reporter[reporter.length] =subReporter;

</code></pre>
						</td>
					</tr>
					<tr id="section_39">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_39">&#182;</a>
							</div>
							<p>do the other report.    </p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>var tLength = TargetsProcessedData.length;
subReporter = &quot;Chart for &quot; +$(&#39;#TargetName&#39;).val();
reporter[reporter.length] =subReporter;	
subReporter = CRLF;
	
    for (l = 0; l &lt; tLength; l++) {
		
	    
</code></pre>
						</td>
					</tr>
					<tr id="section_40">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_40">&#182;</a>
							</div>
							<pre><code>_f_debugP(argetsProcessedData[l]);
debugP(TargetsProcessedData[l]);
</code></pre>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	    
		var sliced = TargetsProcessedData[l].toString().slice(0,6);
		
	        if ( sliced.length&gt;1 )
		{
			subReporter +=  _f__pad(sliced, 6, &quot;0&quot;);
			if ( l != tLength-1 )
				subReporter += &quot;,&quot;;
		}

	        else
        	{
        	        subReporter += sliced;
			if ( l != tLength-1 )
	                	subReporter += &quot;,&quot;;
        	}
    }

	reporter[reporter.length] =subReporter;
	
</code></pre>
						</td>
					</tr>
					<tr id="section_41">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_41">&#182;</a>
							</div>
							<p><em>f</em>_debugBoxP(reporter);</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>
	lastFullChartReport = reporter;

	
</code></pre>
						</td>
					</tr>
					<tr id="section_42">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_42">&#182;</a>
							</div>
							<p>wangle the data into the various arrays - AGAIN
why? it already has subject + target data
<em>f</em>_LoadBothChartsData();</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>/*
debugP(&quot;subject&quot;);
debugP(SubjectProcessedData);
debugP(&quot;target&quot;);
debugP(TargetsProcessedData);
*/

</code></pre>
						</td>
					</tr>
					<tr id="section_43">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_43">&#182;</a>
							</div>
							<p>now populate the array W18 wanted for the weighting</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	relStrength(SubjectProcessedData,TargetsProcessedData );
var charWeighting = relStrength(SubjectProcessedData,TargetsProcessedData );

</code></pre>
						</td>
					</tr>
					<tr id="section_44">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_44">&#182;</a>
							</div>
							<p>now show a chart for that as well</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>	_f__drawWeightingChart(&quot;Weighting&quot;, [$(&#39;#SubjectName&#39;).val(),$(&#39;#TargetName&#39;).val() ], charWeighting , &#39;chart_div_3&#39; );
}

 function add(a, b) {   return a + b;  }
 function relStrength (SubjectData,TargetsData )
	{
		var Subtot =  SubjectData.reduce(add, 0), TargTot =  TargetsData.reduce(add, 0), TotTot = Subtot + TargTot;
</code></pre>
						</td>
					</tr>
					<tr id="section_45">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_45">&#182;</a>
							</div>
							<p>console.log( Subtot, TargTot,  TotTot)</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>		return [ (1.0 / TotTot) * Subtot , (1.0 / TotTot) * TargTot  ];
	}

</code></pre>
						</td>
					</tr>
					<tr id="section_46">
						<td class="docs">
							<div class="pilwrap">
								<a class="pilcrow" href="#section_46">&#182;</a>
							</div>
							<p>tidy up for main charts</p>

						</td>
						<td class="code">
							<pre><code class='prettyprint'>function _f__clearCharts() {

	$(&#39;.chartsHolder&#39;).hide();
	$(&#39;.xchartsHolder&#39;).hide();
	
}
</code></pre>
						</td>
					</tr>
			</tbody>
		</table>
	</div>
</body>
</html>
